# -*- coding: utf-8 -*-
"""M√©tricas de Avalia√ß√£o do Modelo.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/16egLGyFK68yCO7gp8gnXaAh1XMFFd6xI
"""

# Avalia√ß√£o Final com o Melhor Modelo Otimizado

# ------------------------------------------------------------
# Recuperando o melhor modelo encontrado pelo Grid Search
# O m√©todo 'best_estimator_' retorna o modelo com a melhor combina√ß√£o de hiperpar√¢metros
best_rf = grid_search.best_estimator_

# ------------------------------------------------------------
# Fazendo previs√µes com o modelo otimizado no conjunto de teste
y_test_pred = best_rf.predict(X_test)

# ------------------------------------------------------------
# Calculando o F1-score no conjunto de teste
# Usamos a m√©dia macro para considerar todas as classes igualmente
test_f1 = f1_score(y_test, y_test_pred, average='macro')
print(f"F1-score no teste (macro): {test_f1:.4f}")

# ------------------------------------------------------------
# üìã Exibindo o relat√≥rio de classifica√ß√£o completo
# Mostra precis√£o, recall e F1-score por classe
print("\nRelat√≥rio de classifica√ß√£o do melhor modelo:")
print(classification_report(y_test, y_test_pred, target_names=data.target_names))